<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Hilly Road Car Game v2</title>
<style>
body {
  margin: 0;
  font-family: Arial;
  overflow: hidden;
  background: linear-gradient(#87CEEB,#98FB98); /* sky to grass */
}
.screen { display: none; text-align:center;}
.active { display:block;}

button {
  padding:10px 15px;
  margin:5px;
  font-size:18px;
  border-radius:10px;
  cursor:pointer;
}

#startBtn {
  background:red;
  color:white;
  animation: glow 1s infinite alternate;
}

@keyframes glow {
  from { box-shadow:0 0 10px red;}
  to { box-shadow:0 0 25px yellow;}
}

#gameCanvas {
  display:block;
  margin:auto;
  background:#87CEEB;
}

.bar { height:20px; background:grey; width:200px; margin:auto; border-radius:10px;}
.fill { height:100%; background:green; width:100%; border-radius:10px;}

#speedometer {
  position:absolute;
  top:10px;
  right:10px;
  background:white;
  padding:5px;
  border-radius:10px;
  width:80px;
}
</style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="login" class="screen active">
<h1>Enter 5-Digit PIN</h1>
<div id="pinDisplay"></div>
<div id="keypad"></div>
</div>

<!-- HOME SCREEN -->
<div id="home" class="screen">
<h1>ðŸš— Sleeping Man Car Game</h1>
<img src="https://cdn-icons-png.flaticon.com/512/743/743922.png" width="120"><br><br>

Volume:
<button onclick="volumeUp()">+</button>
<button onclick="volumeDown()">-</button>
<br><br>

Difficulty:
<button onclick="setDifficulty(1)">Simple</button>
<button onclick="setDifficulty(2)">Normal</button>
<button onclick="setDifficulty(3)">Hard</button>
<br><br>

<button id="startBtn" onclick="startGame()">START</button>
</div>

<!-- GAME SCREEN -->
<div id="game" class="screen">
<canvas id="gameCanvas" width="800" height="400"></canvas>
<br>
Fuel: <div class="bar"><div id="fuelFill" class="fill"></div></div>
Coins: <span id="coinScore">0</span><br>
Level: <span id="levelScore">0</span><br>
High Score: <span id="highScore">0</span>
<div id="speedometer">
Speed:<br><span id="speedValue">0</span>
</div>
<button onmousedown="accelerate()" onmouseup="stopMove()">â–¶</button>
<button onmousedown="reverse()" onmouseup="stopMove()">â—€</button>
</div>

<script>
let canvas = document.getElementById("gameCanvas");
let ctx = canvas.getContext("2d");

// CAR
let car = {x:100, y:300, width:60, height:30, color:"red", speed:0};

// GAME STATE
let fuel=100;
let coins=0;
let level=0;
let difficulty=1;
let gameRunning=false;
let coinList=[];
let fuelList=[];
let highScore = localStorage.getItem("highScore") || 0;

// PIN LOGIN
let pin="";
let correctPin="12345";
let keypad=document.getElementById("keypad");

for(let i=0;i<=9;i++){
  let btn=document.createElement("button");
  btn.innerText=i;
  btn.onclick=()=>enterPin(i);
  keypad.appendChild(btn);
}

function enterPin(num){
  if(pin.length<5){ pin+=num; document.getElementById("pinDisplay").innerText=pin;}
  if(pin.length===5){
    if(pin===correctPin){ showScreen("home"); }
    else { alert("Wrong PIN"); pin=""; document.getElementById("pinDisplay").innerText=""; }
  }
}

// SHOW SCREEN
function showScreen(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

// DIFFICULTY
function setDifficulty(d){ difficulty=d; }

// CONTROLS
function accelerate(){ car.speed=2*difficulty; }
function reverse(){ car.speed=-2; }
function stopMove(){ car.speed=0; }

// VOLUME (dummy)
let volume=5;
function volumeUp(){ volume++; }
function volumeDown(){ volume--; }

// START GAME
function startGame(){
  showScreen("game");
  fuel=100; coins=0; level=0; car.speed=0; car.x=100; car.y=300;
  coinList=[]; fuelList=[];
  gameRunning=true;
  gameLoop();
}

// DRAW ROAD
function drawRoad(){
  ctx.fillStyle="brown";
  ctx.beginPath();
  ctx.moveTo(0,350);
  for(let i=0;i<=800;i++){
    ctx.lineTo(i,350+Math.sin((i+car.x)/50)*20);
  }
  ctx.lineTo(800,400);
  ctx.lineTo(0,400);
  ctx.closePath();
  ctx.fill();
}

// SPAWN COINS AND FUEL
function spawnItems(){
  if(Math.random()<0.02) coinList.push({x:800, y:300});
  if(Math.random()<0.005) fuelList.push({x:800, y:300});
}

// GAME LOOP
function gameLoop(){
  if(!gameRunning) return;
  ctx.clearRect(0,0,800,400);

  drawRoad();
  spawnItems();

  // DRAW CAR
  car.y = 300 + Math.sin(car.x/50)*20 - car.height/2;
  ctx.fillStyle=car.color;
  ctx.fillRect(car.x, car.y, car.width, car.height);

  // DRAW COINS
  coinList.forEach((coin,i)=>{
    coin.x -= car.speed;
    ctx.fillStyle="gold";
    ctx.beginPath();
    ctx.arc(coin.x,coin.y,10,0,Math.PI*2);
    ctx.fill();
    if(coin.x<car.x+car.width && coin.x>car.x && car.y<coin.y+10 && car.y+car.height>coin.y-10){
      coins++; coinList.splice(i,1);
    }
  });

  // DRAW FUEL
  fuelList.forEach((fuelBox,i)=>{
    fuelBox.x -= car.speed;
    ctx.fillStyle="blue";
    ctx.fillRect(fuelBox.x,fuelBox.y,15,15);
    if(fuelBox.x<car.x+car.width && fuelBox.x>car.x && car.y<fuelBox.y+15 && car.y+car.height>fuelBox.y){
      fuel=Math.min(fuel+30,100);
      fuelList.splice(i,1);
    }
  });

  // UPDATE STATE
  car.x += car.speed;
  fuel -= 0.05*difficulty;
  if(fuel<=0 || car.speed>5*difficulty || car.speed<-5) gameOver();

  document.getElementById("fuelFill").style.width=fuel+"%";
  document.getElementById("coinScore").innerText=coins;
  level=Math.floor(car.x/100);
  document.getElementById("levelScore").innerText=level;
  document.getElementById("speedValue").innerText=car.speed;

  if(level>highScore){ highScore=level; localStorage.setItem("highScore",highScore);}
  document.getElementById("highScore").innerText=highScore;

  requestAnimationFrame(gameLoop);
}

// GAME OVER
function gameOver(){
  gameRunning=false;
  alert("Game Over!");
  showScreen("home");
}

</script>
</body>
</html>
